trigger:
- master

jobs:
- job: Code_Quality
  pool:
    vmImage: 'Ubuntu 16.04'
  container: norionomura/swiftlint:swift-4.2.1
  timeoutInMinutes: 5
  steps:
  - script: |
      set -o pipefail
      swiftlint lint --strict
    displayName: 'swift lint'
  
- job: Linux_Tests
  dependsOn: Code_Quality
  pool:
    vmImage: 'Ubuntu-16.04'
  container: swift:4.2.1
  timeoutInMinutes: 5
  steps:
  - script: |
      set -o pipefail
      swift test --parallel
    displayName: 'swift test'
    
- job: iOS_Tests
  dependsOn: Code_Quality
  pool:
   vmImage: 'macOS 10.13'
  timeoutInMinutes: 5
  steps:
  - task: Xcode@5
    displayName: 'Xcode Tests'
    inputs:
      actions: 'build test'
      scheme: 'Aurora iOS'
      xcodeVersion: '10'
      packageApp: false
      signingOption: "auto"
      useXcpretty: true
      publishJUnitResults: 'build/reports/junit.xml'
      
- job: macOS_Tests
  dependsOn: Code_Quality
  pool:
   vmImage: 'macOS 10.13'
  timeoutInMinutes: 5
  steps:
  - task: Xcode@5
    displayName: 'Xcode Tests'
    inputs:
      actions: 'build test'
      scheme: 'Aurora macOS'
      xcodeVersion: '10'
      packageApp: false
      signingOption: "auto"
      useXcpretty: true
      publishJUnitResults: 'build/reports/junit.xml'
